<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>ClearCore Library: SerialDriver COM Ports</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ClearCore Library
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title"><a class="el" href="class_clear_core_1_1_serial_driver.html" title="ClearCore Serial UART/SPI Connector class. ">SerialDriver</a> COM Ports </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1>Overview </h1>
<p>For applications that require sending or receiving data over a serial port <a class="el" href="namespace_clear_core.html" title="Namespace to encompass the ClearCore board API. ">ClearCore</a> provides two COM ports (COM-0 and COM-1). The COM ports may be interfaced-with using the <a class="el" href="class_clear_core_1_1_serial_driver.html" title="ClearCore Serial UART/SPI Connector class. ">SerialDriver</a> class.<br />
 In code, these connectors are represented by ConnectorCOM0 and ConnectorCOM1.</p>
<p>For UART communications the SerialDrivers may have their operational mode configured to facilitate either TTL or RS-232 wiring schemes. For SPI communications there is an SPI mode. The <a class="el" href="class_clear_core_1_1_serial_driver.html" title="ClearCore Serial UART/SPI Connector class. ">SerialDriver</a><br />
 connectors also have an auxiliary mode called CCIO. This mode is used to connect to the <a class="el" href="namespace_clear_core.html" title="Namespace to encompass the ClearCore board API. ">ClearCore</a> I/O Expansion Board (CCIO-8) which provides eight additional digital I/O points.</p>
<h2>Wiring and Initialization </h2>
<ul>
<li>See the <a href="www.teknic.com/files/downloads/clearcore_system_diagram.pdf#page=4">ClearCore System Diagram</a> for details on wiring COM-0 or COM-1 to a UART device, SPI device, or RS-232 DCE/Modem or DTE/Host.</li>
<li>Initialize the serial port into the correct mode by calling the <a class="el" href="class_clear_core_1_1_serial_driver.html#a3127c6c814b3b7013d3e68d2702e368a">SerialDriver::Mode()</a> function. See below for examples on setting specific modes.</li>
</ul>
<h2>RS-232/TTL Modes </h2>
<p>RS-232 and TTL (UART) modes use one wire (Rx) for receiving and another wire (Tx) for transmitting serial data asynchronously at a pre-determined baud rate. These modes are identical except that<br />
 the signals used are inverted. Data frames are signaled by the use of start and stop bits of opposite polarity. The number of stop bits in a data frame is 1 by default, but may be set to 2. <br />
 Transmission parity may also be configured, but is turned off by default. For each mode, flow control may optionally be enabled to make use of the RTS and CTS lines.</p>
<div class="fragment"><div class="line"><span class="comment">// Configure COM-1 for TTL mode.</span></div><div class="line"><a class="code" href="namespace_clear_core.html#ac0f6d69e425247ee7954281c6a82de05">ConnectorCOM1</a>.<a class="code" href="class_clear_core_1_1_serial_driver.html#a3127c6c814b3b7013d3e68d2702e368a">Mode</a>(<a class="code" href="class_clear_core_1_1_connector.html#a863b805d7850fdc4565bf959b69d1169a71596dc969786ba30f58c79ae1c9e031">Connector::TTL</a>);</div><div class="line"><span class="comment">// Set the data baud rate.</span></div><div class="line"><a class="code" href="namespace_clear_core.html#ac0f6d69e425247ee7954281c6a82de05">ConnectorCOM1</a>.<a class="code" href="class_clear_core_1_1_serial_driver.html#afc1dcaa217daeed0801b34623066aa11">Speed</a>(9600);</div><div class="line"><span class="comment">// Open the serial port to enable data transmission.</span></div><div class="line"><a class="code" href="namespace_clear_core.html#ac0f6d69e425247ee7954281c6a82de05">ConnectorCOM1</a>.<a class="code" href="class_clear_core_1_1_serial_driver.html#a583dc2ffd0550bc7a7c916f4e3998e30">PortOpen</a>();</div></div><!-- fragment --><div class="fragment"><div class="line"><span class="comment">// Configure COM-0 for RS-232 mode.</span></div><div class="line"><a class="code" href="namespace_clear_core.html#a748569765cfde0a971ddb9eebb89e327">ConnectorCOM0</a>.<a class="code" href="class_clear_core_1_1_serial_driver.html#a3127c6c814b3b7013d3e68d2702e368a">Mode</a>(<a class="code" href="class_clear_core_1_1_connector.html#a863b805d7850fdc4565bf959b69d1169a51c1a731b9adeda30d7d65911c11446f">Connector::RS232</a>);</div><div class="line"><span class="comment">// Set the data baud rate.</span></div><div class="line"><a class="code" href="namespace_clear_core.html#a748569765cfde0a971ddb9eebb89e327">ConnectorCOM0</a>.<a class="code" href="class_clear_core_1_1_serial_driver.html#afc1dcaa217daeed0801b34623066aa11">Speed</a>(115200);</div><div class="line"><span class="comment">// (Optional) Set the data frame parity.</span></div><div class="line"><a class="code" href="namespace_clear_core.html#a748569765cfde0a971ddb9eebb89e327">ConnectorCOM0</a>.<a class="code" href="class_clear_core_1_1_serial_base.html#a7ed079b181cfc0e67eac4bb1a5109c93">Parity</a>(<a class="code" href="class_clear_core_1_1_i_serial.html#a119c765cfaec942545a6660f0d01a498ae1a33f5fb9c7a630378d22a95ca6427c">SerialBase::PARITY_O</a>);</div><div class="line"><span class="comment">// (Optional) Set each data frame to use 2 stop bits.</span></div><div class="line"><a class="code" href="namespace_clear_core.html#a748569765cfde0a971ddb9eebb89e327">ConnectorCOM0</a>.<a class="code" href="class_clear_core_1_1_serial_base.html#ac2dcf6e72a56e7710b60e1dd5a07dd6e">StopBits</a>(2);</div><div class="line"><span class="comment">// (Optional) Enable flow control.</span></div><div class="line"><a class="code" href="namespace_clear_core.html#a748569765cfde0a971ddb9eebb89e327">ConnectorCOM0</a>.<a class="code" href="class_clear_core_1_1_serial_base.html#a245d37bbf9e8ef6d42a9b2e9d50a6666">FlowControl</a>(<span class="keyword">true</span>);</div><div class="line"><span class="comment">// Open the serial port to enable data transmission.</span></div><div class="line"><a class="code" href="namespace_clear_core.html#a748569765cfde0a971ddb9eebb89e327">ConnectorCOM0</a>.<a class="code" href="class_clear_core_1_1_serial_driver.html#a583dc2ffd0550bc7a7c916f4e3998e30">PortOpen</a>();</div></div><!-- fragment --><p>Once the port is open use Send() to output characters or numeric data to the serial port. Use SendLine() to send data appended with carriage return and newline characters.</p>
<div class="fragment"><div class="line"><span class="comment">// Output some data to COM-0.</span></div><div class="line"><a class="code" href="namespace_clear_core.html#a748569765cfde0a971ddb9eebb89e327">ConnectorCOM0</a>.<a class="code" href="class_clear_core_1_1_i_serial.html#aa609f4a056cecb71d7ebe13fc74937fd">Send</a>(<span class="stringliteral">&quot;Hello, &quot;</span>);</div><div class="line"><a class="code" href="namespace_clear_core.html#a748569765cfde0a971ddb9eebb89e327">ConnectorCOM0</a>.<a class="code" href="class_clear_core_1_1_i_serial.html#a0928b2e44a4f0432f5caa72a47c3db7f">SendLine</a>(<span class="stringliteral">&quot;world!&quot;</span>);</div></div><!-- fragment --><p>To halt serial communications close the port using the <a class="el" href="class_clear_core_1_1_serial_driver.html#afb88a24c0022a172646939d0592fdec7">SerialDriver::PortClose()</a> function. Once the port is closed data will no longer be received by or transmitted from the serial port. <br />
 The port will only start receiving input again when it is re-opened.</p>
<div class="fragment"><div class="line"><span class="comment">// Close COM-0 to end serial communications.</span></div><div class="line"><a class="code" href="namespace_clear_core.html#a748569765cfde0a971ddb9eebb89e327">ConnectorCOM0</a>.<a class="code" href="class_clear_core_1_1_serial_driver.html#afb88a24c0022a172646939d0592fdec7">PortClose</a>();</div></div><!-- fragment --><h2>SPI Mode </h2>
<p>SPI (Serial Peripheral Interface) is a synchronous data transfer protocol; besides lines for transmitting and receiving data there is also a dedicated clock (SCK) to synchronize transfers. With <br />
 the <a class="el" href="namespace_clear_core.html" title="Namespace to encompass the ClearCore board API. ">ClearCore</a> acting as an SPI master device the MOSI (Master Out, Slave In) line is analogous to the Tx signal, while the MISO (Master In, Slave Out) line is analogous to the Rx signal in <br />
 RS-232/TTL modes. As in RS-232/TTL modes, the speed of data transfers is set by the Speed() function. The difference is that in SPI there are no start or stop bits since data transfer is <br />
 synchronized using the clock signal. The polarity of the SPI clock can be configured to be idle low (default) or idle high. The SPI clock's phase may be configured so that data is sampled on a <br />
 falling edge and shifted out on a rising edge (default) or vice versa.</p>
<div class="fragment"><div class="line"><span class="comment">// Configure COM-0 for SPI mode.</span></div><div class="line"><a class="code" href="namespace_clear_core.html#a748569765cfde0a971ddb9eebb89e327">ConnectorCOM0</a>.<a class="code" href="class_clear_core_1_1_serial_driver.html#a3127c6c814b3b7013d3e68d2702e368a">Mode</a>(<a class="code" href="class_clear_core_1_1_connector.html#a863b805d7850fdc4565bf959b69d1169acbf9fbdb53fa07c1fc443e528f07ec8d">Connector::SPI</a>);</div><div class="line"><span class="comment">// Set the clock frequency / data transfer rate.</span></div><div class="line"><a class="code" href="namespace_clear_core.html#a748569765cfde0a971ddb9eebb89e327">ConnectorCOM0</a>.<a class="code" href="class_clear_core_1_1_serial_driver.html#afc1dcaa217daeed0801b34623066aa11">Speed</a>(9600);</div><div class="line"><span class="comment">// Set the SPI clock polarity and phase to match the target device.</span></div><div class="line"><a class="code" href="namespace_clear_core.html#a748569765cfde0a971ddb9eebb89e327">ConnectorCOM0</a>.<a class="code" href="class_clear_core_1_1_serial_base.html#a8214887417610961ac947cf61aeae730">SpiClock</a>(<a class="code" href="class_clear_core_1_1_serial_base.html#adcbfb8d0559f14441d909c5e6d5978f8a45eb5e175def1620a9d665d5874af903">SerialDriver::SCK_HIGH</a>, <a class="code" href="class_clear_core_1_1_serial_base.html#afe055327aeed6092c7b512d725c82ffaa8f4a2de0374aa93da4fc80849c3f3227">SerialDriver::LEAD_SAMPLE</a>);</div><div class="line"><span class="comment">// Open the serial port to enable data transmission.</span></div><div class="line"><a class="code" href="namespace_clear_core.html#a748569765cfde0a971ddb9eebb89e327">ConnectorCOM0</a>.<a class="code" href="class_clear_core_1_1_serial_driver.html#a583dc2ffd0550bc7a7c916f4e3998e30">PortOpen</a>();</div></div><!-- fragment --><p>Toggle the Slave Select line to send to or receive data from the connected SPI device. </p><div class="fragment"><div class="line"><span class="comment">// Assert the Slave Select line to begin data transfer.</span></div><div class="line"><a class="code" href="namespace_clear_core.html#a748569765cfde0a971ddb9eebb89e327">ConnectorCOM0</a>.<a class="code" href="class_clear_core_1_1_serial_base.html#ab7638eeb72d10b4062c6f98f7156e114">SpiSsMode</a>(<a class="code" href="class_clear_core_1_1_serial_base.html#adf1b4cedd24eb2d91cfb3d2c87781dd3afefd74bf7e7f186a610d50f492deeac2">SerialDriver::LINE_ON</a>);</div><div class="line"><span class="comment">// Receive up to 100 bytes of data from the connected SPI device.</span></div><div class="line">uint8_t received[100] = {0};</div><div class="line"><a class="code" href="namespace_clear_core.html#a748569765cfde0a971ddb9eebb89e327">ConnectorCOM0</a>.<a class="code" href="class_clear_core_1_1_serial_base.html#a9210eec629c96634745e4116523bbaef">SpiTransferData</a>(<span class="keyword">nullptr</span>, received, 100);</div><div class="line"><span class="comment">// De-assert the Slave Select line to end data transfer.</span></div><div class="line"><a class="code" href="namespace_clear_core.html#a748569765cfde0a971ddb9eebb89e327">ConnectorCOM0</a>.<a class="code" href="class_clear_core_1_1_serial_base.html#ab7638eeb72d10b4062c6f98f7156e114">SpiSsMode</a>(<a class="code" href="class_clear_core_1_1_serial_base.html#adf1b4cedd24eb2d91cfb3d2c87781dd3a184b39558344ae0eec9212d96ec61aee">SerialDriver::LINE_OFF</a>);</div></div><!-- fragment --><p>To halt serial communications close the port using the <a class="el" href="class_clear_core_1_1_serial_driver.html#afb88a24c0022a172646939d0592fdec7">SerialDriver::PortClose()</a> function. Once the port is closed, data will no longer be received by or transmitted from the serial port. <br />
 The port will only start receiving input again when it is re-opened.</p>
<div class="fragment"><div class="line"><span class="comment">// Close COM-0 to end serial communications.</span></div><div class="line"><a class="code" href="namespace_clear_core.html#a748569765cfde0a971ddb9eebb89e327">ConnectorCOM0</a>.<a class="code" href="class_clear_core_1_1_serial_driver.html#afb88a24c0022a172646939d0592fdec7">PortClose</a>();</div></div><!-- fragment --><h2>CCIO-8 Mode </h2>
<p>Both <a class="el" href="class_clear_core_1_1_serial_driver.html" title="ClearCore Serial UART/SPI Connector class. ">SerialDriver</a> ports may be configured for communications with up to eight <a class="el" href="namespace_clear_core.html" title="Namespace to encompass the ClearCore board API. ">ClearCore</a> I/O Expansion Boards (CCIO-8). The operations of the attached CCIO-8 boards will be controlled by <br />
 <a class="el" href="namespace_clear_core.html" title="Namespace to encompass the ClearCore board API. ">ClearCore</a>'s <a class="el" href="class_clear_core_1_1_ccio_board_manager.html" title="ClearCore I/O Expansion Board Manager Class. ">CcioBoardManager</a>, but the initial port setup is controlled by the <a class="el" href="class_clear_core_1_1_serial_driver.html" title="ClearCore Serial UART/SPI Connector class. ">SerialDriver</a> functions.</p>
<div class="fragment"><div class="line"><span class="comment">// Set the mode of COM-0 to control the attached CCIO-8 boards.</span></div><div class="line"><a class="code" href="namespace_clear_core.html#a748569765cfde0a971ddb9eebb89e327">ConnectorCOM0</a>.<a class="code" href="class_clear_core_1_1_serial_driver.html#a3127c6c814b3b7013d3e68d2702e368a">Mode</a>(<a class="code" href="class_clear_core_1_1_connector.html#a863b805d7850fdc4565bf959b69d1169a2c659d81811aa8cd3d2c696240e7d800">Connector::CCIO</a>);</div><div class="line"><span class="comment">// Open the serial port in CCIO-8 mode.</span></div><div class="line"><a class="code" href="namespace_clear_core.html#a748569765cfde0a971ddb9eebb89e327">ConnectorCOM0</a>.<a class="code" href="class_clear_core_1_1_serial_driver.html#a583dc2ffd0550bc7a7c916f4e3998e30">PortOpen</a>();</div></div><!-- fragment --><p>The <a class="el" href="class_clear_core_1_1_ccio_board_manager.html" title="ClearCore I/O Expansion Board Manager Class. ">CcioBoardManager</a> controls closing down of the CCIO-8 link and its associated serial port. </p><div class="fragment"><div class="line"><span class="comment">// Close down the CCIO-8 link when we&#39;re done.</span></div><div class="line"><a class="code" href="namespace_clear_core.html#a5a7f45ef03e374fb866b2d45889d2907">CcioMgr</a>.LinkClose();</div></div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
